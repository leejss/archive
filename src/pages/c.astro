---
import Root from "@/layout/root.astro";
import { formatPublishedAt } from "@/utils/common";
import { getCollection } from "astro:content";

const c = (await getCollection("c")).sort(
  (a, b) =>
    new Date(b.data.publishedAt).getTime() -
    new Date(a.data.publishedAt).getTime(),
);
---

<Root title="Learning C">
  <main class="container">
    <div class="intro">
      <h1 class="page-title">Learning C</h1>
    </div>
    <ul class="post-list">
      {
        c.length > 0 ? (
          c.map((post) => (
            <li class="post-item">
              <a href={`/c/${post.id}`} class="post-link">
                <h2 class="post-title">{post.data.title}</h2>
                {post.data.publishedAt && (
                  <time
                    datetime={post.data.publishedAt.toISOString()}
                    class="post-date"
                  >
                    {formatPublishedAt(post.data.publishedAt)}
                  </time>
                )}
              </a>
            </li>
          ))
        ) : (
          <li class="empty-message">아직 작성된 기록이 없습니다.</li>
        )
      }
    </ul>
  </main>
</Root>

<style>
  .intro {
    padding: 1rem 0.5rem;
  }

  .page-title {
    font-size: 3rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    color: var(--default-text-color);
  }

  .page-desc {
    font-size: 1.1rem;
    line-height: 1.6;
    color: var(--default-text-color);
    opacity: 0.8;
    max-width: 60ch;
  }

  .divider {
    height: 1px;
    background: var(--default-text-color);
    opacity: 0.1;
    margin-bottom: 3rem;
    width: 100%;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .post-item {
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s ease;
  }

  .post-link {
    display: block;
    padding: 1.5rem 0rem;
    text-decoration: none;
    color: inherit;
    border-radius: 0.5rem;
    transition:
      transform 0.08s ease,
      background-color 0.2s ease;
  }

  .post-link:hover {
    background-color: rgba(var(--default-text-color-rgb), 0.03);
  }

  .post-title {
    font-size: 1.5rem;
    margin: 0;
    color: var(--default-text-color);
    display: inline;
    /* Hover underline animation */
    background-image: linear-gradient(currentColor, currentColor);
    background-repeat: no-repeat;
    background-position: 0 100%;
    background-size: 0% 2px;
    transition: background-size 0.2s ease;
  }

  .post-link:hover .post-title {
    background-size: 100% 2px;
  }

  .post-date {
    display: block;
    margin-top: 0.5rem;
    font-size: 0.9rem;
    color: var(--default-text-color);
    opacity: 0.6;
    font-family: "AtkinsonHyperlegibleMono", monospace;
  }

  .empty-message {
    padding: 3rem 0;
    text-align: center;
    color: var(--default-text-color);
    opacity: 0.6;
    font-style: italic;
  }
</style>
